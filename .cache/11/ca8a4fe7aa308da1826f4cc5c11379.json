{"id":"src/clientUtil.js","dependencies":[{"name":"/home/sandip/chris-utils/package.json","includedInParent":true,"mtime":1652136077431},{"name":"@fnndsc/chrisapi","loc":{"line":1,"column":19,"index":19},"parent":"/home/sandip/chris-utils/src/clientUtil.js","resolved":"/home/sandip/chris-utils/node_modules/@fnndsc/chrisapi/dist/chrisapi.js"},{"name":"./pluginUtil","loc":{"line":2,"column":23,"index":62},"parent":"/home/sandip/chris-utils/src/clientUtil.js","resolved":"/home/sandip/chris-utils/src/pluginUtil.js"},{"name":"./filesUtil","loc":{"line":3,"column":22,"index":100},"parent":"/home/sandip/chris-utils/src/clientUtil.js","resolved":"/home/sandip/chris-utils/src/filesUtil.js"},{"name":"./feedUtil","loc":{"line":4,"column":21,"index":136},"parent":"/home/sandip/chris-utils/src/clientUtil.js","resolved":"/home/sandip/chris-utils/src/feedUtil.js"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _chrisapi = _interopRequireDefault(require(\"@fnndsc/chrisapi\"));\n\nvar _pluginUtil = _interopRequireDefault(require(\"./pluginUtil\"));\n\nvar _filesUtil = _interopRequireDefault(require(\"./filesUtil\"));\n\nvar _feedUtil = _interopRequireDefault(require(\"./feedUtil\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nvar ClientUtil = /*#__PURE__*/function () {\n  /**\n   * Constructor\n   *\n   * \n   */\n  function ClientUtil(url, userName, chrisClient) {\n    _classCallCheck(this, ClientUtil);\n\n    this.url = url;\n    this.userName = userName;\n    this.chrisClient = chrisClient;\n  }\n  /**\n   * Login to CUBE\n   *\n   * @param  {String} url CUBE's url\n   * @param  {String} userName User's username in CUBE\n   * @param  {String} password User's password\n   * @return {Promise<Object>} JS Promise, resolves to an object of this class\n   */\n\n\n  _createClass(ClientUtil, [{\n    key: \"createUploadFeed\",\n    value:\n    /**\n     * Upload files to CUBE\n     *\n     * @param {Array} files An array of files object\n     * @param {String} feedName name of the 'pl-dircopy' instance in CUBE\n     *\n     * @return {Promise<String>}  JS Promise, resolves to a string value \n     */\n    function () {\n      var _createUploadFeed = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(files, feedName) {\n        var filesService, uploadDirName, feedService, newFeed;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // Upload files\n                filesService = _filesUtil.default.createService(this.chrisClient);\n                _context.next = 3;\n                return filesService.uploadFiles(files);\n\n              case 3:\n                uploadDirName = _context.sent;\n                // Create a new feed\n                feedService = _feedUtil.default.createService(this.chrisClient);\n                _context.next = 7;\n                return feedService.createFeed(uploadDirName, feedName);\n\n              case 7:\n                newFeed = _context.sent;\n                return _context.abrupt(\"return\", newFeed);\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function createUploadFeed(_x, _x2) {\n        return _createUploadFeed.apply(this, arguments);\n      }\n\n      return createUploadFeed;\n    }()\n  }, {\n    key: \"createDownloadFeed\",\n    value:\n    /**\n     * Create a downloading feed given a feed id\n     *\n     *\n     *\n     */\n    function () {\n      var _createDownloadFeed = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(feedId, newFeedName) {\n        var feedService, feed, feedDirPath, newFeed;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                // Fetch the feed\n                feedService = _feedUtil.default.createService(this.chrisClient);\n                _context2.next = 3;\n                return feedService.getFeed(feedId);\n\n              case 3:\n                feed = _context2.sent;\n                feedDirPath = feed.data.creator_username + \"/feed_\" + feedId; // create a new feed & zip contents\n\n                _context2.next = 7;\n                return feedService.createAndZipFeed(feedDirPath, newFeedName, feed.data.name);\n\n              case 7:\n                newFeed = _context2.sent;\n                return _context2.abrupt(\"return\", newFeed);\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function createDownloadFeed(_x3, _x4) {\n        return _createDownloadFeed.apply(this, arguments);\n      }\n\n      return createDownloadFeed;\n    }()\n  }, {\n    key: \"logout\",\n    value:\n    /**\n    * Logout from CUBE\n    *\n    *\n    */\n    function logout() {\n      this.client = null;\n    }\n  }], [{\n    key: \"createService\",\n    value: function () {\n      var _createService = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(url, userName, password) {\n        var authUrl, authToken, auth, chrisClient;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                authUrl = url + 'auth-token/';\n                _context3.next = 3;\n                return _chrisapi.default.getAuthToken(authUrl, userName, password);\n\n              case 3:\n                authToken = _context3.sent;\n                auth = {\n                  token: authToken\n                };\n                chrisClient = new _chrisapi.default(url, auth);\n                return _context3.abrupt(\"return\", new ClientUtil(url, userName, chrisClient));\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      function createService(_x5, _x6, _x7) {\n        return _createService.apply(this, arguments);\n      }\n\n      return createService;\n    }()\n  }, {\n    key: \"getService\",\n    value:\n    /**\n     * Get an instance of this class given an existing chris client\n     *\n     * @param {Object} chrisClient A ChRIS client object\n     *\n     * @return {Promise<Object>} JS Promise, resolves to an instance of this class\n     */\n    function () {\n      var _getService = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(chrisClient) {\n        var url, user;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                url = \"\";\n                _context4.next = 3;\n                return chrisClient.getUser();\n\n              case 3:\n                user = _context4.sent;\n                return _context4.abrupt(\"return\", new ClientUtil(url, user.data.username, chrisClient));\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      function getService(_x8) {\n        return _getService.apply(this, arguments);\n      }\n\n      return getService;\n    }()\n  }]);\n\n  return ClientUtil;\n}();\n\nexports.default = ClientUtil;"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":8,"column":0},"source":"src/clientUtil.js","original":{"line":1,"column":0}},{"generated":{"line":10,"column":0},"source":"src/clientUtil.js","original":{"line":2,"column":0}},{"generated":{"line":12,"column":0},"source":"src/clientUtil.js","original":{"line":3,"column":0}},{"generated":{"line":14,"column":0},"source":"src/clientUtil.js","original":{"line":4,"column":0}},{"generated":{"line":28,"column":4},"source":"src/clientUtil.js","original":{"line":7,"column":21},"name":"ClientUtil"},{"generated":{"line":29,"column":2},"source":"src/clientUtil.js","original":{"line":9,"column":2}},{"generated":{"line":30,"column":0},"source":"src/clientUtil.js","original":{"line":10,"column":0}},{"generated":{"line":31,"column":0},"source":"src/clientUtil.js","original":{"line":11,"column":0}},{"generated":{"line":32,"column":0},"source":"src/clientUtil.js","original":{"line":12,"column":0}},{"generated":{"line":33,"column":0},"source":"src/clientUtil.js","original":{"line":13,"column":0}},{"generated":{"line":34,"column":2},"source":"src/clientUtil.js","original":{"line":14,"column":2}},{"generated":{"line":34,"column":22},"source":"src/clientUtil.js","original":{"line":14,"column":14},"name":"url"},{"generated":{"line":34,"column":25},"source":"src/clientUtil.js","original":{"line":14,"column":2}},{"generated":{"line":34,"column":27},"source":"src/clientUtil.js","original":{"line":14,"column":19},"name":"userName"},{"generated":{"line":34,"column":35},"source":"src/clientUtil.js","original":{"line":14,"column":2}},{"generated":{"line":34,"column":37},"source":"src/clientUtil.js","original":{"line":14,"column":29},"name":"chrisClient"},{"generated":{"line":34,"column":48},"source":"src/clientUtil.js","original":{"line":14,"column":2}},{"generated":{"line":34,"column":50},"source":"src/clientUtil.js","original":{"line":14,"column":41}},{"generated":{"line":35,"column":4},"source":"src/clientUtil.js","original":{"line":14,"column":41}},{"generated":{"line":37,"column":4},"source":"src/clientUtil.js","original":{"line":15,"column":4}},{"generated":{"line":37,"column":9},"source":"src/clientUtil.js","original":{"line":15,"column":9},"name":"url"},{"generated":{"line":37,"column":12},"source":"src/clientUtil.js","original":{"line":15,"column":4}},{"generated":{"line":37,"column":15},"source":"src/clientUtil.js","original":{"line":15,"column":15},"name":"url"},{"generated":{"line":37,"column":18},"source":"src/clientUtil.js","original":{"line":15,"column":4}},{"generated":{"line":38,"column":4},"source":"src/clientUtil.js","original":{"line":16,"column":4}},{"generated":{"line":38,"column":9},"source":"src/clientUtil.js","original":{"line":16,"column":9},"name":"userName"},{"generated":{"line":38,"column":17},"source":"src/clientUtil.js","original":{"line":16,"column":4}},{"generated":{"line":38,"column":20},"source":"src/clientUtil.js","original":{"line":16,"column":20},"name":"userName"},{"generated":{"line":38,"column":28},"source":"src/clientUtil.js","original":{"line":16,"column":4}},{"generated":{"line":39,"column":4},"source":"src/clientUtil.js","original":{"line":17,"column":4}},{"generated":{"line":39,"column":9},"source":"src/clientUtil.js","original":{"line":17,"column":9},"name":"chrisClient"},{"generated":{"line":39,"column":20},"source":"src/clientUtil.js","original":{"line":17,"column":4}},{"generated":{"line":39,"column":23},"source":"src/clientUtil.js","original":{"line":17,"column":23},"name":"chrisClient"},{"generated":{"line":39,"column":34},"source":"src/clientUtil.js","original":{"line":17,"column":4}},{"generated":{"line":40,"column":2},"source":"src/clientUtil.js","original":{"line":19,"column":3}},{"generated":{"line":41,"column":2},"source":"src/clientUtil.js","original":{"line":20,"column":2}},{"generated":{"line":42,"column":0},"source":"src/clientUtil.js","original":{"line":21,"column":0}},{"generated":{"line":43,"column":0},"source":"src/clientUtil.js","original":{"line":22,"column":0}},{"generated":{"line":44,"column":0},"source":"src/clientUtil.js","original":{"line":23,"column":0}},{"generated":{"line":45,"column":0},"source":"src/clientUtil.js","original":{"line":24,"column":0}},{"generated":{"line":46,"column":0},"source":"src/clientUtil.js","original":{"line":25,"column":0}},{"generated":{"line":47,"column":0},"source":"src/clientUtil.js","original":{"line":26,"column":0}},{"generated":{"line":48,"column":0},"source":"src/clientUtil.js","original":{"line":27,"column":0}},{"generated":{"line":54,"column":4},"source":"src/clientUtil.js","original":{"line":57,"column":2}},{"generated":{"line":55,"column":0},"source":"src/clientUtil.js","original":{"line":58,"column":0}},{"generated":{"line":56,"column":0},"source":"src/clientUtil.js","original":{"line":59,"column":0}},{"generated":{"line":57,"column":0},"source":"src/clientUtil.js","original":{"line":60,"column":0}},{"generated":{"line":58,"column":0},"source":"src/clientUtil.js","original":{"line":61,"column":0}},{"generated":{"line":59,"column":0},"source":"src/clientUtil.js","original":{"line":62,"column":0}},{"generated":{"line":60,"column":0},"source":"src/clientUtil.js","original":{"line":63,"column":0}},{"generated":{"line":61,"column":0},"source":"src/clientUtil.js","original":{"line":64,"column":0}},{"generated":{"line":63,"column":86},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":63,"column":103},"source":"src/clientUtil.js","original":{"line":65,"column":25},"name":"files"},{"generated":{"line":63,"column":108},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":63,"column":110},"source":"src/clientUtil.js","original":{"line":65,"column":31},"name":"feedName"},{"generated":{"line":63,"column":118},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":64,"column":8},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":65,"column":8},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":66,"column":10},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":67,"column":12},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":68,"column":14},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":69,"column":16},"source":"src/clientUtil.js","original":{"line":67,"column":5}},{"generated":{"line":70,"column":16},"source":"src/clientUtil.js","original":{"line":68,"column":11},"name":"filesService"},{"generated":{"line":70,"column":28},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":70,"column":31},"source":"src/clientUtil.js","original":{"line":68,"column":26},"name":"FilesUtil"},{"generated":{"line":70,"column":50},"source":"src/clientUtil.js","original":{"line":68,"column":36},"name":"createService"},{"generated":{"line":70,"column":63},"source":"src/clientUtil.js","original":{"line":68,"column":26}},{"generated":{"line":70,"column":64},"source":"src/clientUtil.js","original":{"line":68,"column":50}},{"generated":{"line":70,"column":69},"source":"src/clientUtil.js","original":{"line":68,"column":55},"name":"chrisClient"},{"generated":{"line":70,"column":80},"source":"src/clientUtil.js","original":{"line":68,"column":26}},{"generated":{"line":70,"column":81},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":71,"column":16},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":72,"column":16},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":72,"column":23},"source":"src/clientUtil.js","original":{"line":69,"column":33},"name":"filesService"},{"generated":{"line":72,"column":35},"source":"src/clientUtil.js","original":{"line":69,"column":45}},{"generated":{"line":72,"column":36},"source":"src/clientUtil.js","original":{"line":69,"column":46},"name":"uploadFiles"},{"generated":{"line":72,"column":47},"source":"src/clientUtil.js","original":{"line":69,"column":33}},{"generated":{"line":72,"column":48},"source":"src/clientUtil.js","original":{"line":69,"column":58},"name":"files"},{"generated":{"line":72,"column":53},"source":"src/clientUtil.js","original":{"line":69,"column":33}},{"generated":{"line":72,"column":54},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":74,"column":14},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":75,"column":16},"source":"src/clientUtil.js","original":{"line":69,"column":11},"name":"uploadDirName"},{"generated":{"line":75,"column":29},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":76,"column":16},"source":"src/clientUtil.js","original":{"line":71,"column":5}},{"generated":{"line":77,"column":16},"source":"src/clientUtil.js","original":{"line":72,"column":11},"name":"feedService"},{"generated":{"line":77,"column":27},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":77,"column":30},"source":"src/clientUtil.js","original":{"line":72,"column":25},"name":"FeedUtil"},{"generated":{"line":77,"column":48},"source":"src/clientUtil.js","original":{"line":72,"column":34},"name":"createService"},{"generated":{"line":77,"column":61},"source":"src/clientUtil.js","original":{"line":72,"column":25}},{"generated":{"line":77,"column":62},"source":"src/clientUtil.js","original":{"line":72,"column":48}},{"generated":{"line":77,"column":67},"source":"src/clientUtil.js","original":{"line":72,"column":53},"name":"chrisClient"},{"generated":{"line":77,"column":78},"source":"src/clientUtil.js","original":{"line":72,"column":25}},{"generated":{"line":77,"column":79},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":78,"column":16},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":79,"column":16},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":79,"column":23},"source":"src/clientUtil.js","original":{"line":73,"column":27},"name":"feedService"},{"generated":{"line":79,"column":34},"source":"src/clientUtil.js","original":{"line":73,"column":38}},{"generated":{"line":79,"column":35},"source":"src/clientUtil.js","original":{"line":73,"column":39},"name":"createFeed"},{"generated":{"line":79,"column":45},"source":"src/clientUtil.js","original":{"line":73,"column":27}},{"generated":{"line":79,"column":46},"source":"src/clientUtil.js","original":{"line":73,"column":50},"name":"uploadDirName"},{"generated":{"line":79,"column":59},"source":"src/clientUtil.js","original":{"line":73,"column":27}},{"generated":{"line":79,"column":61},"source":"src/clientUtil.js","original":{"line":73,"column":65},"name":"feedName"},{"generated":{"line":79,"column":69},"source":"src/clientUtil.js","original":{"line":73,"column":27}},{"generated":{"line":79,"column":70},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":81,"column":14},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":82,"column":16},"source":"src/clientUtil.js","original":{"line":73,"column":11},"name":"newFeed"},{"generated":{"line":82,"column":23},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":83,"column":16},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":83,"column":49},"source":"src/clientUtil.js","original":{"line":74,"column":12},"name":"newFeed"},{"generated":{"line":83,"column":56},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":85,"column":14},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":86,"column":14},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":87,"column":16},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":88,"column":12},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":89,"column":10},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":90,"column":8},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":91,"column":6},"source":"src/clientUtil.js","original":{"line":65,"column":2}},{"generated":{"line":102,"column":4},"source":"src/clientUtil.js","original":{"line":78,"column":2}},{"generated":{"line":103,"column":0},"source":"src/clientUtil.js","original":{"line":79,"column":0}},{"generated":{"line":104,"column":0},"source":"src/clientUtil.js","original":{"line":80,"column":0}},{"generated":{"line":105,"column":0},"source":"src/clientUtil.js","original":{"line":81,"column":0}},{"generated":{"line":106,"column":0},"source":"src/clientUtil.js","original":{"line":82,"column":0}},{"generated":{"line":107,"column":0},"source":"src/clientUtil.js","original":{"line":83,"column":0}},{"generated":{"line":109,"column":88},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":109,"column":106},"source":"src/clientUtil.js","original":{"line":84,"column":27},"name":"feedId"},{"generated":{"line":109,"column":112},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":109,"column":114},"source":"src/clientUtil.js","original":{"line":84,"column":35},"name":"newFeedName"},{"generated":{"line":109,"column":125},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":110,"column":8},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":111,"column":8},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":112,"column":10},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":113,"column":12},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":114,"column":14},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":115,"column":16},"source":"src/clientUtil.js","original":{"line":86,"column":4}},{"generated":{"line":116,"column":16},"source":"src/clientUtil.js","original":{"line":87,"column":10},"name":"feedService"},{"generated":{"line":116,"column":27},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":116,"column":30},"source":"src/clientUtil.js","original":{"line":87,"column":24},"name":"FeedUtil"},{"generated":{"line":116,"column":48},"source":"src/clientUtil.js","original":{"line":87,"column":33},"name":"createService"},{"generated":{"line":116,"column":61},"source":"src/clientUtil.js","original":{"line":87,"column":24}},{"generated":{"line":116,"column":62},"source":"src/clientUtil.js","original":{"line":87,"column":47}},{"generated":{"line":116,"column":67},"source":"src/clientUtil.js","original":{"line":87,"column":52},"name":"chrisClient"},{"generated":{"line":116,"column":78},"source":"src/clientUtil.js","original":{"line":87,"column":24}},{"generated":{"line":116,"column":79},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":117,"column":16},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":118,"column":16},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":118,"column":23},"source":"src/clientUtil.js","original":{"line":88,"column":23},"name":"feedService"},{"generated":{"line":118,"column":34},"source":"src/clientUtil.js","original":{"line":88,"column":34}},{"generated":{"line":118,"column":35},"source":"src/clientUtil.js","original":{"line":88,"column":35},"name":"getFeed"},{"generated":{"line":118,"column":42},"source":"src/clientUtil.js","original":{"line":88,"column":23}},{"generated":{"line":118,"column":43},"source":"src/clientUtil.js","original":{"line":88,"column":43},"name":"feedId"},{"generated":{"line":118,"column":49},"source":"src/clientUtil.js","original":{"line":88,"column":23}},{"generated":{"line":118,"column":50},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":120,"column":14},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":121,"column":16},"source":"src/clientUtil.js","original":{"line":88,"column":10},"name":"feed"},{"generated":{"line":121,"column":20},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":122,"column":16},"source":"src/clientUtil.js","original":{"line":89,"column":10},"name":"feedDirPath"},{"generated":{"line":122,"column":27},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":122,"column":30},"source":"src/clientUtil.js","original":{"line":89,"column":24},"name":"feed"},{"generated":{"line":122,"column":34},"source":"src/clientUtil.js","original":{"line":89,"column":28}},{"generated":{"line":122,"column":35},"source":"src/clientUtil.js","original":{"line":89,"column":29},"name":"data"},{"generated":{"line":122,"column":39},"source":"src/clientUtil.js","original":{"line":89,"column":24}},{"generated":{"line":122,"column":40},"source":"src/clientUtil.js","original":{"line":89,"column":34},"name":"creator_username"},{"generated":{"line":122,"column":56},"source":"src/clientUtil.js","original":{"line":89,"column":24}},{"generated":{"line":122,"column":59},"source":"src/clientUtil.js","original":{"line":89,"column":53}},{"generated":{"line":122,"column":67},"source":"src/clientUtil.js","original":{"line":89,"column":24}},{"generated":{"line":122,"column":70},"source":"src/clientUtil.js","original":{"line":89,"column":64},"name":"feedId"},{"generated":{"line":122,"column":76},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":122,"column":78},"source":"src/clientUtil.js","original":{"line":91,"column":4}},{"generated":{"line":124,"column":16},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":125,"column":16},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":125,"column":23},"source":"src/clientUtil.js","original":{"line":92,"column":26},"name":"feedService"},{"generated":{"line":125,"column":34},"source":"src/clientUtil.js","original":{"line":92,"column":37}},{"generated":{"line":125,"column":35},"source":"src/clientUtil.js","original":{"line":92,"column":38},"name":"createAndZipFeed"},{"generated":{"line":125,"column":51},"source":"src/clientUtil.js","original":{"line":92,"column":26}},{"generated":{"line":125,"column":52},"source":"src/clientUtil.js","original":{"line":92,"column":55},"name":"feedDirPath"},{"generated":{"line":125,"column":63},"source":"src/clientUtil.js","original":{"line":92,"column":26}},{"generated":{"line":125,"column":65},"source":"src/clientUtil.js","original":{"line":92,"column":68},"name":"newFeedName"},{"generated":{"line":125,"column":76},"source":"src/clientUtil.js","original":{"line":92,"column":26}},{"generated":{"line":125,"column":78},"source":"src/clientUtil.js","original":{"line":92,"column":81},"name":"feed"},{"generated":{"line":125,"column":82},"source":"src/clientUtil.js","original":{"line":92,"column":85}},{"generated":{"line":125,"column":83},"source":"src/clientUtil.js","original":{"line":92,"column":86},"name":"data"},{"generated":{"line":125,"column":87},"source":"src/clientUtil.js","original":{"line":92,"column":81}},{"generated":{"line":125,"column":88},"source":"src/clientUtil.js","original":{"line":92,"column":91},"name":"name"},{"generated":{"line":125,"column":92},"source":"src/clientUtil.js","original":{"line":92,"column":26}},{"generated":{"line":125,"column":93},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":127,"column":14},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":128,"column":16},"source":"src/clientUtil.js","original":{"line":92,"column":10},"name":"newFeed"},{"generated":{"line":128,"column":23},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":129,"column":16},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":129,"column":50},"source":"src/clientUtil.js","original":{"line":93,"column":11},"name":"newFeed"},{"generated":{"line":129,"column":57},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":131,"column":14},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":132,"column":14},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":133,"column":16},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":134,"column":12},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":135,"column":10},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":136,"column":8},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":137,"column":6},"source":"src/clientUtil.js","original":{"line":84,"column":2}},{"generated":{"line":148,"column":4},"source":"src/clientUtil.js","original":{"line":96,"column":3}},{"generated":{"line":149,"column":0},"source":"src/clientUtil.js","original":{"line":97,"column":0}},{"generated":{"line":150,"column":0},"source":"src/clientUtil.js","original":{"line":98,"column":0}},{"generated":{"line":151,"column":0},"source":"src/clientUtil.js","original":{"line":99,"column":0}},{"generated":{"line":152,"column":0},"source":"src/clientUtil.js","original":{"line":100,"column":0}},{"generated":{"line":153,"column":4},"source":"src/clientUtil.js","original":{"line":101,"column":3}},{"generated":{"line":153,"column":22},"source":"src/clientUtil.js","original":{"line":101,"column":11}},{"generated":{"line":154,"column":6},"source":"src/clientUtil.js","original":{"line":102,"column":5}},{"generated":{"line":154,"column":11},"source":"src/clientUtil.js","original":{"line":102,"column":10},"name":"client"},{"generated":{"line":154,"column":17},"source":"src/clientUtil.js","original":{"line":102,"column":5}},{"generated":{"line":154,"column":20},"source":"src/clientUtil.js","original":{"line":102,"column":17}},{"generated":{"line":154,"column":24},"source":"src/clientUtil.js","original":{"line":102,"column":5}},{"generated":{"line":155,"column":4},"source":"src/clientUtil.js","original":{"line":103,"column":4}},{"generated":{"line":159,"column":83},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":159,"column":101},"source":"src/clientUtil.js","original":{"line":28,"column":29},"name":"url"},{"generated":{"line":159,"column":104},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":159,"column":106},"source":"src/clientUtil.js","original":{"line":28,"column":33},"name":"userName"},{"generated":{"line":159,"column":114},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":159,"column":116},"source":"src/clientUtil.js","original":{"line":28,"column":42},"name":"password"},{"generated":{"line":159,"column":124},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":160,"column":8},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":161,"column":8},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":162,"column":10},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":163,"column":12},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":164,"column":14},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":165,"column":16},"source":"src/clientUtil.js","original":{"line":30,"column":10},"name":"authUrl"},{"generated":{"line":165,"column":23},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":165,"column":26},"source":"src/clientUtil.js","original":{"line":30,"column":20},"name":"url"},{"generated":{"line":165,"column":29},"source":"src/clientUtil.js","original":{"line":30,"column":23}},{"generated":{"line":165,"column":32},"source":"src/clientUtil.js","original":{"line":30,"column":26}},{"generated":{"line":165,"column":45},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":166,"column":16},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":167,"column":16},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":167,"column":23},"source":"src/clientUtil.js","original":{"line":32,"column":27},"name":"Client"},{"generated":{"line":167,"column":41},"source":"src/clientUtil.js","original":{"line":32,"column":34},"name":"getAuthToken"},{"generated":{"line":167,"column":53},"source":"src/clientUtil.js","original":{"line":32,"column":27}},{"generated":{"line":167,"column":54},"source":"src/clientUtil.js","original":{"line":32,"column":47},"name":"authUrl"},{"generated":{"line":167,"column":61},"source":"src/clientUtil.js","original":{"line":32,"column":27}},{"generated":{"line":167,"column":63},"source":"src/clientUtil.js","original":{"line":32,"column":56},"name":"userName"},{"generated":{"line":167,"column":71},"source":"src/clientUtil.js","original":{"line":32,"column":27}},{"generated":{"line":167,"column":73},"source":"src/clientUtil.js","original":{"line":32,"column":65},"name":"password"},{"generated":{"line":167,"column":81},"source":"src/clientUtil.js","original":{"line":32,"column":27}},{"generated":{"line":167,"column":82},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":169,"column":14},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":170,"column":16},"source":"src/clientUtil.js","original":{"line":32,"column":10},"name":"authToken"},{"generated":{"line":170,"column":25},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":171,"column":16},"source":"src/clientUtil.js","original":{"line":34,"column":10},"name":"auth"},{"generated":{"line":171,"column":20},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":171,"column":23},"source":"src/clientUtil.js","original":{"line":34,"column":17}},{"generated":{"line":172,"column":18},"source":"src/clientUtil.js","original":{"line":34,"column":18},"name":"token"},{"generated":{"line":172,"column":23},"source":"src/clientUtil.js","original":{"line":34,"column":23}},{"generated":{"line":172,"column":25},"source":"src/clientUtil.js","original":{"line":34,"column":25},"name":"authToken"},{"generated":{"line":173,"column":16},"source":"src/clientUtil.js","original":{"line":34,"column":17}},{"generated":{"line":173,"column":17},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":174,"column":16},"source":"src/clientUtil.js","original":{"line":36,"column":10},"name":"chrisClient"},{"generated":{"line":174,"column":27},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":174,"column":30},"source":"src/clientUtil.js","original":{"line":36,"column":24}},{"generated":{"line":174,"column":34},"source":"src/clientUtil.js","original":{"line":36,"column":28},"name":"Client"},{"generated":{"line":174,"column":51},"source":"src/clientUtil.js","original":{"line":36,"column":24}},{"generated":{"line":174,"column":52},"source":"src/clientUtil.js","original":{"line":36,"column":35},"name":"url"},{"generated":{"line":174,"column":55},"source":"src/clientUtil.js","original":{"line":36,"column":24}},{"generated":{"line":174,"column":57},"source":"src/clientUtil.js","original":{"line":36,"column":40},"name":"auth"},{"generated":{"line":174,"column":61},"source":"src/clientUtil.js","original":{"line":36,"column":24}},{"generated":{"line":174,"column":62},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":175,"column":16},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":175,"column":50},"source":"src/clientUtil.js","original":{"line":38,"column":11}},{"generated":{"line":175,"column":54},"source":"src/clientUtil.js","original":{"line":38,"column":15},"name":"ClientUtil"},{"generated":{"line":175,"column":64},"source":"src/clientUtil.js","original":{"line":38,"column":11}},{"generated":{"line":175,"column":65},"source":"src/clientUtil.js","original":{"line":38,"column":26},"name":"url"},{"generated":{"line":175,"column":68},"source":"src/clientUtil.js","original":{"line":38,"column":11}},{"generated":{"line":175,"column":70},"source":"src/clientUtil.js","original":{"line":38,"column":30},"name":"userName"},{"generated":{"line":175,"column":78},"source":"src/clientUtil.js","original":{"line":38,"column":11}},{"generated":{"line":175,"column":80},"source":"src/clientUtil.js","original":{"line":38,"column":39},"name":"chrisClient"},{"generated":{"line":175,"column":91},"source":"src/clientUtil.js","original":{"line":38,"column":11}},{"generated":{"line":175,"column":92},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":177,"column":14},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":178,"column":14},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":179,"column":16},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":180,"column":12},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":181,"column":10},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":182,"column":8},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":183,"column":6},"source":"src/clientUtil.js","original":{"line":28,"column":2}},{"generated":{"line":194,"column":4},"source":"src/clientUtil.js","original":{"line":42,"column":2}},{"generated":{"line":195,"column":0},"source":"src/clientUtil.js","original":{"line":43,"column":0}},{"generated":{"line":196,"column":0},"source":"src/clientUtil.js","original":{"line":44,"column":0}},{"generated":{"line":197,"column":0},"source":"src/clientUtil.js","original":{"line":45,"column":0}},{"generated":{"line":198,"column":0},"source":"src/clientUtil.js","original":{"line":46,"column":0}},{"generated":{"line":199,"column":0},"source":"src/clientUtil.js","original":{"line":47,"column":0}},{"generated":{"line":200,"column":0},"source":"src/clientUtil.js","original":{"line":48,"column":0}},{"generated":{"line":202,"column":80},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":202,"column":98},"source":"src/clientUtil.js","original":{"line":49,"column":26},"name":"chrisClient"},{"generated":{"line":202,"column":109},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":203,"column":8},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":204,"column":8},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":205,"column":10},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":206,"column":12},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":207,"column":14},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":208,"column":16},"source":"src/clientUtil.js","original":{"line":51,"column":12},"name":"url"},{"generated":{"line":208,"column":19},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":208,"column":22},"source":"src/clientUtil.js","original":{"line":51,"column":18}},{"generated":{"line":208,"column":24},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":209,"column":16},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":210,"column":16},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":210,"column":23},"source":"src/clientUtil.js","original":{"line":52,"column":25},"name":"chrisClient"},{"generated":{"line":210,"column":34},"source":"src/clientUtil.js","original":{"line":52,"column":36}},{"generated":{"line":210,"column":35},"source":"src/clientUtil.js","original":{"line":52,"column":37},"name":"getUser"},{"generated":{"line":210,"column":42},"source":"src/clientUtil.js","original":{"line":52,"column":25}},{"generated":{"line":210,"column":44},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":212,"column":14},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":213,"column":16},"source":"src/clientUtil.js","original":{"line":52,"column":12},"name":"user"},{"generated":{"line":213,"column":20},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":214,"column":16},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":214,"column":50},"source":"src/clientUtil.js","original":{"line":54,"column":13}},{"generated":{"line":214,"column":54},"source":"src/clientUtil.js","original":{"line":54,"column":17},"name":"ClientUtil"},{"generated":{"line":214,"column":64},"source":"src/clientUtil.js","original":{"line":54,"column":13}},{"generated":{"line":214,"column":65},"source":"src/clientUtil.js","original":{"line":54,"column":28},"name":"url"},{"generated":{"line":214,"column":68},"source":"src/clientUtil.js","original":{"line":54,"column":13}},{"generated":{"line":214,"column":70},"source":"src/clientUtil.js","original":{"line":54,"column":33},"name":"user"},{"generated":{"line":214,"column":74},"source":"src/clientUtil.js","original":{"line":54,"column":37}},{"generated":{"line":214,"column":75},"source":"src/clientUtil.js","original":{"line":54,"column":38},"name":"data"},{"generated":{"line":214,"column":79},"source":"src/clientUtil.js","original":{"line":54,"column":33}},{"generated":{"line":214,"column":80},"source":"src/clientUtil.js","original":{"line":54,"column":43},"name":"username"},{"generated":{"line":214,"column":88},"source":"src/clientUtil.js","original":{"line":54,"column":13}},{"generated":{"line":214,"column":90},"source":"src/clientUtil.js","original":{"line":54,"column":53},"name":"chrisClient"},{"generated":{"line":214,"column":101},"source":"src/clientUtil.js","original":{"line":54,"column":13}},{"generated":{"line":214,"column":102},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":216,"column":14},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":217,"column":14},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":218,"column":16},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":219,"column":12},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":220,"column":10},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":221,"column":8},"source":"src/clientUtil.js","original":{"line":49,"column":2}},{"generated":{"line":222,"column":6},"source":"src/clientUtil.js","original":{"line":49,"column":2}}],"sources":{"src/clientUtil.js":"import Client from \"@fnndsc/chrisapi\";\nimport PluginUtil from \"./pluginUtil\";\nimport FilesUtil from \"./filesUtil\";\nimport FeedUtil from \"./feedUtil\";\n\n\nexport default class ClientUtil{\n\n  /**\n   * Constructor\n   *\n   * \n   */\n  constructor(url, userName, chrisClient){\n    this.url = url;\n    this.userName = userName;\n    this.chrisClient = chrisClient;\n    \n  }\n  /**\n   * Login to CUBE\n   *\n   * @param  {String} url CUBE's url\n   * @param  {String} userName User's username in CUBE\n   * @param  {String} password User's password\n   * @return {Promise<Object>} JS Promise, resolves to an object of this class\n   */\n  static async createService(url,userName,password){\n  \n    const authUrl = url + 'auth-token/';\n      \n    const authToken= await Client.getAuthToken(authUrl, userName,password);\n    \n    const auth = {token :authToken};\n    \n    const chrisClient = new Client(url, auth);\n\n    return new ClientUtil(url,userName,chrisClient);\n    \n  };\n  \n  /**\n   * Get an instance of this class given an existing chris client\n   *\n   * @param {Object} chrisClient A ChRIS client object\n   *\n   * @return {Promise<Object>} JS Promise, resolves to an instance of this class\n   */\n  static async getService(chrisClient){\n      \n      const url = \"\";\n      const user = await chrisClient.getUser();\n      \n      return new ClientUtil(url, user.data.username, chrisClient);\n  };\n  \n  /**\n   * Upload files to CUBE\n   *\n   * @param {Array} files An array of files object\n   * @param {String} feedName name of the 'pl-dircopy' instance in CUBE\n   *\n   * @return {Promise<String>}  JS Promise, resolves to a string value \n   */\n  async createUploadFeed(files,feedName){\n     \n     // Upload files\n     const filesService = FilesUtil.createService(this.chrisClient);\n     const uploadDirName = await filesService.uploadFiles(files);\n    \n     // Create a new feed\n     const feedService = FeedUtil.createService(this.chrisClient);\n     const newFeed = await feedService.createFeed(uploadDirName, feedName);\n     return newFeed;\n    \n  };\n    \n  /**\n   * Create a downloading feed given a feed id\n   *\n   *\n   *\n   */\n  async createDownloadFeed(feedId, newFeedName){\n  \n    // Fetch the feed\n    const feedService = FeedUtil.createService(this.chrisClient);\n    const feed = await feedService.getFeed(feedId);\n    const feedDirPath = feed.data.creator_username + \"/feed_\" + feedId;\n    \n    // create a new feed & zip contents\n    const newFeed = await feedService.createAndZipFeed(feedDirPath, newFeedName, feed.data.name);\n    return newFeed;\n    \n  };\n   /**\n   * Logout from CUBE\n   *\n   *\n   */\n   logout(){\n     this.client=null;\n   };\n}\n"},"lineCount":null}},"error":null,"hash":"d35c6c6fe3b912f2e619a97f040e72eb","cacheData":{"env":{}}}